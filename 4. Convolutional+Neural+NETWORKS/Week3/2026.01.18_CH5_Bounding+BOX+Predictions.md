# My Diary

Today  **{{DATE_PRETTY}}**.

## General Counter
It has been    **{{DAY_SINCE_2025_08_18}}** days since I started this diary.

# Repository Counter

Day **{{DAYS_SINCE_REPO_START}}** From I started this repository


# The YOLO Algorithm (You Only Look Once)

## 1. The Grid Strategy
Instead of sliding a window across the image, YOLO divides the input image into an $S \times S$ grid (e.g., $3 \times 3$, though $19 \times 19$ is common in practice).

**The Assignment Rule:**
* An object is assigned to **exactly one** grid cell.
* Which one? The cell that contains the **midpoint** (center) of the object.
* *Even if the object spans multiple cells, it belongs only to the cell with the midpoint.*


## 2. The Output Volume
Each of the grid cells acts like the "Localization" classifier we built earlier.
* For each cell, the network outputs a target vector $y$:
$$y = \begin{bmatrix} p_c \\ b_x \\ b_y \\ b_h \\ b_w \\ c_1 \\ c_2 \\ c_3 \end{bmatrix}$$
* **Dimensions:**
    * Grid: $S \times S$ (e.g., $3 \times 3$).
    * Vector Depth: $5 + \text{classes}$ (e.g., $5 + 3 = 8$).
    * **Total Output Volume:** $3 \times 3 \times 8$.
* **Interpretation:** The top-left pixel of the output volume ($1 \times 1 \times 8$) tells you if there is an object in the top-left grid cell and where it is.

## 3. Encoding Bounding Boxes
How do we write $b_x, b_y, b_h, b_w$? They are specified **relative to the grid cell**.

* **$b_x, b_y$ (Center):**
    * Top-left of the cell is $(0, 0)$. Bottom-right of the cell is $(1, 1)$.
    * The midpoint is always inside the cell, so $b_x, b_y$ are always between 0 and 1.
* **$b_h, b_w$ (Shape):**
    * Specified as a fraction of the **grid cell size**, not the image size.
    * If a car is wider than the grid cell, $b_w$ can be greater than 1 (e.g., 1.5 means 1.5x the width of the grid cell).


## 4. Why "You Only Look Once"?
Unlike sliding windows which run the network hundreds of times (cropping and predicting), YOLO uses a single Convolutional Network (ConvNet).
* You feed the image **once**.
* The network performs convolutions.
* The final output is the $S \times S \times 8$ volume.
* All predictions for all grid cells are computed simultaneously in one forward pass. This makes it incredibly fast (real-time).

## 5. Relation to Earlier Concepts
* **Convolutional Sliding Windows:** YOLO is essentially the "Convolutional Sliding Window" idea but with a smarter labeling scheme. Instead of just outputting "Car/No Car", it outputs precise bounding box coordinates ($b_x, b_y...$) for every window position (grid cell) at once.
* **Localization:** We reuse the exact same 8-unit output vector ($p_c, b_x...$) defined in the Localization section, but now we tile it across a grid.

## 6. Basic Chunk Implementation (Relative to Absolute)
This function converts the relative YOLO coordinates back to absolute image coordinates for plotting.

```python
def yolo_to_absolute(bx, by, bw, bh, cell_x, cell_y, cell_size_pixels):
    """
    Converts YOLO relative coordinates to absolute pixel coordinates.
    bx, by: Relative center (0-1) inside the cell
    cell_x, cell_y: Index of the grid cell (e.g., 1, 2)
    """
    # 1. Calculate Absolute Center
    # cell_x * size moves us to the cell's left edge
    # bx * size moves us into the cell
    center_x = (cell_x + bx) * cell_size_pixels
    center_y = (cell_y + by) * cell_size_pixels
    
    # 2. Calculate Absolute Width/Height
    width = bw * cell_size_pixels
    height = bh * cell_size_pixels
    
    return center_x, center_y, width, height
